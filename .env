# YouTube Content Intelligence & Repurposing Platform
# Phase 1 Configuration - Fully Functional CLI

# Deployment
DEPLOYMENT_MODE=LOCAL
DEBUG=false

# Storage
STORAGE_PATH=/Volumes/Seagate Exp/Mac 2025/code/yt-dl-sub/downloads

# Database  
DATABASE_URL=sqlite+aiosqlite:///data/yt-dl-sub.db

# AI Backend (Phase 1: CLI)
AI_BACKEND=claude_cli
AI_MODEL=claude-3-haiku-20240307
AI_MAX_TOKENS=2000
QUALITY_CHECKS_ENABLED=true
QUALITY_CHECK_SAMPLE_RATE=1.0

# Prevention Systems Configuration
USE_ENHANCED_MONITOR=false

# Rate Limiting Configuration (Unified Prevention System)
# These settings control all YouTube API interactions with enhanced protection
PREVENTION_RATE_LIMIT=30                      # Requests per minute (was YOUTUBE_RATE_LIMIT=10)
PREVENTION_BURST_SIZE=10                      # Burst allowance (was YOUTUBE_BURST_SIZE=3)  
PREVENTION_CIRCUIT_BREAKER_THRESHOLD=5        # Open circuit after N 429 errors (was YOUTUBE_MAX_FAILURES_BEFORE_STOP=3)
PREVENTION_CIRCUIT_BREAKER_TIMEOUT=60         # Circuit recovery timeout in seconds (was YOUTUBE_COOLDOWN_MINUTES=5)
PREVENTION_MIN_REQUEST_INTERVAL=2.0           # Minimum seconds between requests (DEPRECATED - use PREVENTION_BASE_INTERVAL)
PREVENTION_BACKOFF_BASE=2.0                   # Exponential backoff multiplier (was YOUTUBE_BACKOFF_MULTIPLIER=2.0)
PREVENTION_BACKOFF_MAX=300.0                  # Maximum backoff delay in seconds

# Bulletproof Jittered Rate Limiting (NEW - replaces fixed intervals)
PREVENTION_JITTER_TYPE=full                   # Jitter algorithm: 'full', 'equal', 'decorrelated', or 'none' (for backward compatibility)
PREVENTION_BASE_INTERVAL=1.5                 # Base interval for jittered calculations (seconds)
PREVENTION_JITTER_VARIANCE=1.0               # Jitter variance multiplier (1.0 = full variance, 0.5 = 50% variance)

# MIGRATION NOTE: Legacy YOUTUBE_* variables are deprecated but supported for backward compatibility
# - YOUTUBE_RATE_LIMIT -> PREVENTION_RATE_LIMIT  
# - YOUTUBE_BURST_SIZE -> PREVENTION_BURST_SIZE
# - YOUTUBE_MAX_FAILURES_BEFORE_STOP -> PREVENTION_CIRCUIT_BREAKER_THRESHOLD
# - YOUTUBE_COOLDOWN_MINUTES -> PREVENTION_CIRCUIT_BREAKER_TIMEOUT (converted from minutes to seconds)
# - YOUTUBE_BACKOFF_MULTIPLIER -> PREVENTION_BACKOFF_BASE

# Channel Enumeration Configuration
DEFAULT_ENUMERATION_STRATEGY=HYBRID
FORCE_COMPLETE_ENUMERATION=false
ENUMERATION_TIMEOUT=300
MAX_VIDEOS_PER_CHANNEL=10000
CACHE_DURATION_HOURS=24
INCREMENTAL_CHECK_INTERVAL=3600

# Video Discovery Verification
VERIFY_CHANNEL_COMPLETENESS=true
DEEP_CHECK_THRESHOLD=100
MISSING_VIDEO_CONFIDENCE=0.85
VERIFICATION_SAMPLE_SIZE=50

# Whisper Transcription
WHISPER_MODEL=base
WHISPER_DEVICE=auto

# YouTube Download Settings (Non-rate-limiting settings)
YOUTUBE_CONCURRENT_DOWNLOADS=2        # Concurrent download workers (not rate limiting related)

# DEPRECATED: Rate limiting settings moved to PREVENTION_* section above
# YOUTUBE_RATE_LIMIT=10               # -> Use PREVENTION_RATE_LIMIT=30
# YOUTUBE_BURST_SIZE=3                # -> Use PREVENTION_BURST_SIZE=10  
# YOUTUBE_COOLDOWN_MINUTES=5          # -> Use PREVENTION_CIRCUIT_BREAKER_TIMEOUT=60
# YOUTUBE_MAX_FAILURES_BEFORE_STOP=3  # -> Use PREVENTION_CIRCUIT_BREAKER_THRESHOLD=5
# YOUTUBE_BACKOFF_MULTIPLIER=2.0      # -> Use PREVENTION_BACKOFF_BASE=2.0
DEFAULT_VIDEO_QUALITY=1080p
DEFAULT_VIDEO_FORMAT=mp4  # Only used when download_audio_only=False
DEFAULT_AUDIO_FORMAT=opus  # Primary default - most downloads are audio-only

# Worker Settings
WORKER_CONCURRENCY=3
MAX_RETRIES=3
RETRY_DELAY=300

# Monitoring
MONITOR_INTERVAL=300
HEALTH_CHECK_INTERVAL=30

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/yt-dl-sub.log
LOG_MAX_BYTES=10000000
LOG_BACKUP_COUNT=5

# Content Generation
CONTENT_GENERATORS=blog,social,summary,newsletter,script

# Review Checkpoint Settings
GENERATION_REVIEW_REQUIRED=true      # Require review before generation
AUTO_APPROVE_GENERATION=false        # Auto-approve all for generation

# Format Selection Settings
FORMAT_SELECTION_REQUIRED=true       # Require format selection after approval
DEFAULT_SELECTED_FORMATS=blog,social # Pre-selected formats
AUTO_SELECT_ALL_FORMATS=false       # Skip selection, use all formats
# CHANNEL_DEFAULT_FORMATS=TED:blog,newsletter;MIT:summary,script

# AI Summary Generation (Optional)
ENABLE_AI_SUMMARIES=false            # Generate AI summaries after transcription
SUMMARY_MODEL=claude-3-haiku-20240307 # Cheaper model for summaries
SUMMARY_MAX_TOKENS=300               # Limit summary token length
AUTO_SUMMARIZE_CHANNELS=TED,MIT      # Always summarize these channels

# API Settings (for Phase 2)
API_HOST=0.0.0.0
API_PORT=8000
API_KEY_REQUIRED=false
API_RATE_LIMIT=60

# Queue
QUEUE_TYPE=sqlite

# Credentials (optional - for Phase 2+)
# CLAUDE_API_KEY=
# OPENAI_API_KEY=
# GEMINI_API_KEY=
# GDRIVE_CREDENTIALS_FILE=
# GDRIVE_FOLDER_ID=
# AIRTABLE_API_KEY=
# AIRTABLE_BASE_ID=
# Storage Version (v1 or v2)
STORAGE_VERSION=v2

# Subtitle Translation Settings
SUBTITLE_TRANSLATION_ENABLED=false  # Enable AI translation of non-English subtitles
SUBTITLE_TARGET_LANGUAGE=en         # Target language for translation
SUBTITLE_TRANSLATION_MODEL=claude-3-haiku-20240307  # Model for translation
SUBTITLE_MAX_TRANSLATION_CHARS=3000 # Limit translation to avoid token limits

# Chinese Punctuation Restoration
CHINESE_PUNCTUATION_ENABLED=true    # Enable AI-powered punctuation restoration for Chinese transcripts
CHINESE_PUNCTUATION_MODEL=sonnet  # Model for punctuation restoration (sonnet works better than haiku for this task)
